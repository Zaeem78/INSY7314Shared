{"ast":null,"code":"/**\n * Utility functions for secure cookie handling\n */\n\n/**\n * Set a cookie with security attributes\n * @param {string} name - Cookie name\n * @param {string} value - Cookie value\n * @param {Object} options - Cookie options\n */\nexport const setCookie = (name, value, options = {}) => {\n  const isProduction = process.env.NODE_ENV === 'production';\n  const secure = isProduction ? '; Secure' : '';\n  const sameSite = isProduction ? '; SameSite=Strict' : '; SameSite=Lax';\n\n  // Default options\n  const defaultOptions = {\n    path: '/',\n    maxAge: 60 * 60 * 24 * 7,\n    // 7 days\n    httpOnly: false,\n    // Only accessible via HTTP(S)\n    secure: isProduction,\n    // Only sent over HTTPS in production\n    sameSite: isProduction ? 'strict' : 'lax'\n  };\n\n  // Merge with provided options\n  const cookieOptions = {\n    ...defaultOptions,\n    ...options\n  };\n\n  // Build cookie string\n  let cookieString = `${encodeURIComponent(name)}=${encodeURIComponent(value)}`;\n\n  // Add options\n  if (cookieOptions.maxAge) {\n    cookieString += `; Max-Age=${cookieOptions.maxAge}`;\n  }\n  if (cookieOptions.path) {\n    cookieString += `; Path=${cookieOptions.path}`;\n  }\n  if (cookieOptions.domain) {\n    cookieString += `; Domain=${cookieOptions.domain}`;\n  }\n  if (cookieOptions.secure) {\n    cookieString += '; Secure';\n  }\n  if (cookieOptions.httpOnly) {\n    cookieString += '; HttpOnly';\n  }\n  if (cookieOptions.sameSite) {\n    cookieString += `; SameSite=${cookieOptions.sameSite.charAt(0).toUpperCase() + cookieOptions.sameSite.slice(1)}`;\n  }\n\n  // Set the cookie\n  document.cookie = cookieString;\n};\n\n/**\n * Get a cookie by name\n * @param {string} name - Cookie name\n * @returns {string|null} - Cookie value or null if not found\n */\nexport const getCookie = name => {\n  const value = `; ${document.cookie}`;\n  const parts = value.split(`; ${name}=`);\n  if (parts.length === 2) {\n    return parts.pop().split(';').shift();\n  }\n  return null;\n};\n\n/**\n * Remove a cookie by name\n * @param {string} name - Cookie name\n * @param {Object} options - Additional cookie options\n */\nexport const removeCookie = (name, options = {}) => {\n  setCookie(name, '', {\n    ...options,\n    maxAge: -1 // Expire immediately\n  });\n};\n\n/**\n * Get all cookies as an object\n * @returns {Object} - Object with all cookies\n */\nexport const getAllCookies = () => {\n  return document.cookie.split(';').reduce((cookies, cookie) => {\n    const [name, value] = cookie.split('=').map(c => c.trim());\n    return {\n      ...cookies,\n      [name]: value\n    };\n  }, {});\n};\n\n/**\n * Check if cookies are enabled\n * @returns {boolean} - True if cookies are enabled\n */\nexport const areCookiesEnabled = () => {\n  try {\n    // Try to set a test cookie\n    const testKey = 'test-cookie-' + Math.random().toString(36).substring(7);\n    setCookie(testKey, 'test');\n\n    // Check if the cookie was set\n    const cookieWasSet = document.cookie.indexOf(testKey) !== -1;\n\n    // Clean up\n    removeCookie(testKey);\n    return cookieWasSet;\n  } catch (e) {\n    return false;\n  }\n};\n\n/**\n * Parse a cookie string into an object\n * @param {string} cookieString - Cookie string from document.cookie\n * @returns {Object} - Parsed cookies\n */\nexport const parseCookies = cookieString => {\n  return cookieString.split(';').reduce((cookies, cookie) => {\n    const [name, value] = cookie.split('=').map(c => c.trim());\n    return {\n      ...cookies,\n      [name]: value\n    };\n  }, {});\n};\nexport default {\n  set: setCookie,\n  get: getCookie,\n  remove: removeCookie,\n  getAll: getAllCookies,\n  enabled: areCookiesEnabled,\n  parse: parseCookies\n};","map":{"version":3,"names":["setCookie","name","value","options","isProduction","process","env","NODE_ENV","secure","sameSite","defaultOptions","path","maxAge","httpOnly","cookieOptions","cookieString","encodeURIComponent","domain","charAt","toUpperCase","slice","document","cookie","getCookie","parts","split","length","pop","shift","removeCookie","getAllCookies","reduce","cookies","map","c","trim","areCookiesEnabled","testKey","Math","random","toString","substring","cookieWasSet","indexOf","e","parseCookies","set","get","remove","getAll","enabled","parse"],"sources":["C:/Users/pc/Desktop/INSY7314Shared/INSY7314/INSY7314/frontend/src/utils/cookies.js"],"sourcesContent":["/**\n * Utility functions for secure cookie handling\n */\n\n/**\n * Set a cookie with security attributes\n * @param {string} name - Cookie name\n * @param {string} value - Cookie value\n * @param {Object} options - Cookie options\n */\nexport const setCookie = (name, value, options = {}) => {\n  const isProduction = process.env.NODE_ENV === 'production';\n  const secure = isProduction ? '; Secure' : '';\n  const sameSite = isProduction ? '; SameSite=Strict' : '; SameSite=Lax';\n  \n  // Default options\n  const defaultOptions = {\n    path: '/',\n    maxAge: 60 * 60 * 24 * 7, // 7 days\n    httpOnly: false, // Only accessible via HTTP(S)\n    secure: isProduction, // Only sent over HTTPS in production\n    sameSite: isProduction ? 'strict' : 'lax'\n  };\n\n  // Merge with provided options\n  const cookieOptions = { ...defaultOptions, ...options };\n\n  // Build cookie string\n  let cookieString = `${encodeURIComponent(name)}=${encodeURIComponent(value)}`;\n  \n  // Add options\n  if (cookieOptions.maxAge) {\n    cookieString += `; Max-Age=${cookieOptions.maxAge}`;\n  }\n  \n  if (cookieOptions.path) {\n    cookieString += `; Path=${cookieOptions.path}`;\n  }\n  \n  if (cookieOptions.domain) {\n    cookieString += `; Domain=${cookieOptions.domain}`;\n  }\n  \n  if (cookieOptions.secure) {\n    cookieString += '; Secure';\n  }\n  \n  if (cookieOptions.httpOnly) {\n    cookieString += '; HttpOnly';\n  }\n  \n  if (cookieOptions.sameSite) {\n    cookieString += `; SameSite=${cookieOptions.sameSite.charAt(0).toUpperCase() + cookieOptions.sameSite.slice(1)}`;\n  }\n\n  // Set the cookie\n  document.cookie = cookieString;\n};\n\n/**\n * Get a cookie by name\n * @param {string} name - Cookie name\n * @returns {string|null} - Cookie value or null if not found\n */\nexport const getCookie = (name) => {\n  const value = `; ${document.cookie}`;\n  const parts = value.split(`; ${name}=`);\n  \n  if (parts.length === 2) {\n    return parts.pop().split(';').shift();\n  }\n  \n  return null;\n};\n\n/**\n * Remove a cookie by name\n * @param {string} name - Cookie name\n * @param {Object} options - Additional cookie options\n */\nexport const removeCookie = (name, options = {}) => {\n  setCookie(name, '', {\n    ...options,\n    maxAge: -1 // Expire immediately\n  });};\n\n/**\n * Get all cookies as an object\n * @returns {Object} - Object with all cookies\n */\nexport const getAllCookies = () => {\n  return document.cookie.split(';').reduce((cookies, cookie) => {\n    const [name, value] = cookie.split('=').map(c => c.trim());\n    return { ...cookies, [name]: value };\n  }, {});\n};\n\n/**\n * Check if cookies are enabled\n * @returns {boolean} - True if cookies are enabled\n */\nexport const areCookiesEnabled = () => {\n  try {\n    // Try to set a test cookie\n    const testKey = 'test-cookie-' + Math.random().toString(36).substring(7);\n    setCookie(testKey, 'test');\n    \n    // Check if the cookie was set\n    const cookieWasSet = document.cookie.indexOf(testKey) !== -1;\n    \n    // Clean up\n    removeCookie(testKey);\n    \n    return cookieWasSet;\n  } catch (e) {\n    return false;\n  }\n};\n\n/**\n * Parse a cookie string into an object\n * @param {string} cookieString - Cookie string from document.cookie\n * @returns {Object} - Parsed cookies\n */\nexport const parseCookies = (cookieString) => {\n  return cookieString.split(';').reduce((cookies, cookie) => {\n    const [name, value] = cookie.split('=').map(c => c.trim());\n    return { ...cookies, [name]: value };\n  }, {});\n};\n\nexport default {\n  set: setCookie,\n  get: getCookie,\n  remove: removeCookie,\n  getAll: getAllCookies,\n  enabled: areCookiesEnabled,\n  parse: parseCookies\n};\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}